<h2>Info</h2>
<h3>Key Malware Behaviours</h3>
<p>
<ul>
  <li><b>Network connections</b>: Malware tends to establish either external network connections or internal connections. External connections allow remote access or for downloading staged payloads from a threat actors' infrastructure. Meanwhile, internal connections allow for lateral movement, a technique used to extend access to other hosts or applications within the network.</li>
  <li><b>Registry key modifications</b>:  Malware typically uses registry keys to establish persistence, a technique used by threat actors to discreetly maintain long-term access to a system despite disruptions. A good example is Registry Run Keys, which allows binaries to be automatically executed when a user logs in or the machine boots up.</li>
  <li><b>File manipulations</b>: Malware also tends to download (one of the common reasons to establish network connections) or create new files needed for its successful execution.</li>
</ul>
</p>
<h2>Static Analysis</h2>
<p>
  Analysing a malware sample without executing the code. This method mainly focuses on profiling the binary with its readable information, such as its properties, program flow and strings. Given the limitation of not executing it, sometimes this method gives insufficient information, which is why we resort to Dynamic Analysis.   
</p>
<h3>DIE : Detect It Easy</h3>
<p>
  Provides information about the file, such as its architecture, significant headers, packer used, and strings.<br>
  https://github.com/horsicq/Detect-It-Easy 
</p>
<h3>Capa</h3>
<p>
  CAPA detects capabilities in executable files. May it be for the installation of a service, invocation of network connections, registry modifications and such.<bR
To start playing with CAPA, fire up the <i>command prompt</i> located in the taskbar and navigate to the Malware Sample directory, with the <i>cd</i> command<br>
<ul><li><i>cd /path/to/file</i></li></ul>
  <b>Note: Capa creates a ".viv" file that we can delete, this a cache file.</b>
</p>
<h3>UPX</h3>
<p>
  In case the malware is packet (depends on the Capa results), we would need to use:<br>
<ul><li><i>upx -d "file"</i></li></ul>
  Then, the file is unpacket, and we analyse again with Capa.
</p>
<h2>Dynamic Analysis</h2>
<p>
  Mainly focuses on understanding the malware by executing it in a safe environment, such as a Sandbox. By doing this, you will see the malware live in action, its exact behaviour, and how it infects the environment.<br>
  Before starting a Dynamic Analysis, we will probably need to change the extension to <b>.exe</b> in order to execute the file
</p>
<h3>Process Monitor</h3>
<p>
  This tool is present in windows and can be used to analyse processes.<br>
  We can filter by <b>Process Name</b> and run the malware (in a safe environment) to check what is going on.<br>
  <h4>Registry Modification</h4>
  <ul>
    <li>RegCreateKey: The "path" on this operation indicates the key created in order to be placed a backdoor</li>
    <li>RegSetValue: The "path" indicates the value of the key created</li>
  </ul>
</p>
  <h4>File Modification</h4>
  <ul>
    <li>WriteFile: The path indicated which file has been writted</li>
    <li>Note: we can exclude CreateFile; CreateFileMapping; QuerySecurityFile; QueryNameInformationFile; QueryBasicInformationFile; CloseFile; ReadFile; in order to see usefull information.</li>
  </ul>
<h4>Network Connections</h4>
<ul>
  <li>TCP network connections are related to C2 command and control server. It can give info about where it is exfiltrating data.</li>
</ul>





